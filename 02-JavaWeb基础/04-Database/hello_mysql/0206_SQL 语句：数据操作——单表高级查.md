## 查 SELECT FROM

**查询的格式如下：**

```SQL
SELECT 字段1, 字段2, ...
FROM 要查询的表
[WHERE 查询条件]
[ORDER BY 要按照哪个字段来进行排序 ASC(代表升序) | DESC(代表降序)]
[LIMIT 这一次拿多少条数据 OFFSET 这一次从哪个偏移位置开始拿数据]
```

## 1、聚合函数

> 聚合函数是一系列函数，用来操作表里所有数据某个字段的值组成的集合

```SQL
-- 查询表里一共有多少条数据
SELECT COUNT(*)
FROM t_product;

-- 查询表里一共有多少条 brand = 0 的数据
SELECT COUNT(*)
FROM t_product
WHERE brand = 0;


-- 查询表里所有手机价格字段的平均值
SELECT AVG(price)
FROM t_product;

-- 查询表里所有苹果手机评分字段的平均值
SELECT AVG(score) AS apple_avg_score
FROM t_product
WHERE brand = 0;


-- 查询表里所有手机价格字段的最大值
SELECT MAX(price)
FROM t_product;

-- 查询表里所有苹果手机评分字段的最小值
SELECT MIN(score) AS apple_lowest_score
FROM t_product
WHERE brand = 0;


-- 查询表里所有苹果手机评分字段的和
SELECT SUM(score)
FROM t_product
WHERE brand = 0;
```

## 2、GROUP BY

> GROUP BY 一般就是用来跟聚合函数联用，执行的原理是：先通过 GROUP BY 的那个字段把所有的数据分成若干组，然后再对每个分组里的数据分别执行聚合函数，最后一次性返回查询结果
> 
> 给 GROUP BY 添加查询条件只能通过 HAVING 关键字，而不能再通过 WHERE 关键字。注意 HAVING 关键字是用来整体过滤掉某个分组的，而不是用来过滤掉某一条数据的（也就是说先通过 GROUP BY 的那个字段把所有的数据分成若干组后，紧接着会通过 HAVING 关键字的条件过滤掉不满足的条件的那些组），所以过滤条件里的字段只能是聚合函数操作或者是聚合函数操作的别名

比如我们想查询苹果手机一共有几款手机、最高价格是多少、平均评分是多少，同时也想查询华为手机一共有几款手机、最高价格是多少、平均评分是多少，还想同时查询小米手机一共有几款手机、最高价格是多少、平均评分是多少

如果没有 GROUP BY 的话，就只能分三次查询：

```SQL
-- 查询苹果手机的信息
SELECT
	brand,
	COUNT(*) AS apple_count,
	MAX(price) AS apple_max_price,
	AVG(score) AS apple_agv_score
FROM t_product
WHERE brand = 0;
	
-- 查询华为手机的信息
SELECT
	brand,
	COUNT(*) AS hw_count,
	MAX(price) AS hw_max_price,
	AVG(score) AS hw_agv_score
FROM t_product 
WHERE brand = 1;
	
-- 查询小米手机的信息
SELECT
	brand,
	COUNT(*) AS mi_count,
	MAX(price) AS mi_max_price,
	AVG(score) AS mi_agv_score
FROM t_product 
WHERE brand = 2;
```

而有了 GROUP BY 的话，我们就可以通过分组的方式，一次查询搞定，执行的原理是：先通过 GROUP BY 的那个字段把所有的数据分成若干组，然后再对每个分组里的数据分别执行聚合函数，最后一次性返回查询结果

```SQL
-- 查询各品牌手机的信息
SELECT
	brand,
	COUNT(*) AS count,
	MAX(price) AS max_price,
	AVG(score) AS agv_score
FROM t_product 
GROUP BY brand;
```

如果我们想对 GROUP BY 附加查询条件，得用 HAVING 附加，不能再用 WHERE

```SQL
-- 查询各手机品牌的信息，但是只保留最高价格在 8000 块以下的分组
SELECT
	brand,
	COUNT(*) AS count,
	MAX(price) AS max_price,
	AVG(score) AS agv_score
FROM t_product 
GROUP BY brand HAVING max_price <= 8000;
```
