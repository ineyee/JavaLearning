## 一、SpringBoot 是什么

前面我们使用 SSM 开发项目的时候，有一个很明显的感受就是每次开发一个新项目都得为各个层：添加一大堆的依赖 + 编写一大堆的配置，这个过程繁琐、重复，而且一旦某个环节出错整个项目就出错了。

SpringBoot 就是为解决这些问题而生的框架，使用 SpringBoot 开发项目的时候，它会自动帮我们为各个层：添加常用的依赖 + 编写常用的配置，可以大大简化我们的开发代码。并且 SpringBoot 还内置了 Tomcat，这就使得项目可以直接运行，我们都不用像以前那样在本机自己安装 Tomcat 了。

## 二、怎么使用 SpringBoot（这里拿 controller 层做演示）

#### 1、【还是像以前一样】创建项目

用 IDEA 创建一个 Maven 项目/模块：

* IDEA - New Project - Maven Archetype
* Name：hello-spring-boot
* Location：项目所在父目录

* JDK：选择相应版本的 JDK
* Catalog：提供不同的 Archetype 列表
  * Internal（一般选这个就够用了）：IDE 自带的 Archetype 列表，不依赖网络，模板有限
  * Default Local：本地 Maven 仓库里已有的 Archetype 列表（~/.m2/repository），如果之前下载过模板会显示
  * Maven Central：官方 Maven 中央仓库提供的 Archetype 列表，网络可访问最新模板，模板最全

* Archetype：Maven 的项目模板，用来快速生成一个规范化的项目结构和配置文件
  * maven-archetype-webapp：Web 项目模板，生成 WEB-INF、web.xml 等基础结构
  * maven-archetype-quickstart：最基本的 Java 项目模板，包含 main/test 目录，这里选择这个

* GroupId（公司域名倒写）：com.ineyee
* Artifact（默认就是项目名）
* Version（项目版本号）：1.0.0
* Create（这样就创建好了项目）

#### 2、编辑 pom.xml 文件

* 添加 parent 标签，让当前项目继承自 spring-boot-starter-parent 项目

```xml
<!--
    添加 parent 标签，让当前项目继承自 spring-boot-starter-parent 项目
    这个项目里已经帮我们锁定了一堆常用三方库的版本，从而避免开发中依赖间的版本冲突
-->
<parent>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-parent</artifactId>
    <version>4.0.1</version>
</parent>
```

* 添加一个 spring-boot-starter-web 依赖，不用指定版本号，因为上面 spring-boot-starter-parent 项目里已经帮我们锁定好了

```xml
<!--
    添加一个 spring-boot-starter-web 依赖，不用指定版本号，因为上面 spring-boot-starter-parent 项目里已经帮我们锁定好了
    这个库里已经帮我们添加了 Tomcat 和 SpringMVC ————即 controller 层————常用的依赖，就不用我们自己手动添加一大堆依赖了
-->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-web</artifactId>
</dependency>
```

#### 3、创建 SpringBoot 项目的入口类和入口方法，跟 controller 目录平级

```java
// 创建 SpringBoot 项目的入口类，我们一般把它命名为 Application
// 用 @SpringBootApplication 注解修饰一下这个类，来标识它是 SpringBoot 项目的入口类
// 并且 @SpringBootApplication 注解还包含了 @ComponentScan 注解的功能，它默认就会扫描当前类所在包及其子包下所有的类，创建对象并放到 IoC 容器中
@SpringBootApplication
public class Application {
    // 为项目的入口类添加 main 方法，作为项目的入口方法
    public static void main(String[] args) {
        // 固定写法，启动 SpringBoot 应用
        SpringApplication.run(Application.class, args);
    }
}
```

#### 4、【还是像以前一样】创建 controller 层，编写接口

* 第一步：创建一个 controller 类，不需要继承自任何父类
* 第二步：用 @Controller 注解修饰一下这个类，以便 Spring 框架能自动创建一个该类的对象并放到 IoC 容器里
* 第三步：定义一个方法，这个方法就是一个接口
  * 用 @RequestMapping(path = requestPath, method = requestMethod) 注解修饰这个方法来指定请求路径和请求方法，以便 Spring 框架能把来自客户端的请求精准分发到该方法
  * 用 @ResponseBody 注解修饰一下这个方法，这样一来 Spring 框架就会自动把该方法的返回值作为响应体返回给客户端并结束本次请求了

```java
// 第一步：创建一个 controller 类，不需要继承自任何父类
// 约定俗成地我们会把这个类命名为 XxxController
//
// 第二步：用 @Controller 注解修饰一下这个类，以便 Spring 框架能自动创建一个该类的对象并放到 IoC 容器里
// 对象默认的 beanId 就是它所属类名的第一个字母变成小写（即 loginController），当然我们也可以通过 value 属性来自定义 beanId（value 属性名可以省略不写，直接写值）
@Controller
public class LoginController {
    // 第三步：定义一个方法，这个方法就是一个接口
    // 用 @RequestMapping(path = requestPath, method = requestMethod) 注解修饰这个方法来指定请求路径和请求方法，以便 Spring 框架能把来自客户端的请求精准分发到该方法
    //     path 属性用来指定请求路径，注意 / 不能少
    //     method 属性用来指定请求方法
    // 用 @ResponseBody 注解修饰一下这个方法，这样一来 Spring 框架就会自动把该方法的返回值作为响应体返回给客户端并结束本次请求了
    @RequestMapping(path = "/login", method = RequestMethod.GET)
    @ResponseBody
    public String login1() {
        return "get success";
    }

    @RequestMapping(path = "/login", method = RequestMethod.POST)
    @ResponseBody
    public String login2() {
        return "post success";
    }
}
```

## 三、项目操作

#### 1、开发过程中的启动项目

之前我们是自己在 IDEA 里配置 Tomcat，然后启动项目的。现在因为 SpringBoot 内置了 Tomcat（默认的端口是 8080，默认的 ApplicationContextPath 是 /），并且我们通过代码提供了 SpringBoot 项目的入口类 Application 和入口方法 main，所以只需要直接运行 Application 的 main 方法即可启动项目。

#### 2、开发过程中的热部署项目

开发过程中，我们修改了代码，如果想使新代码生效，有两种方式：冷启动和热部署。冷启动就是重新启动项目，速度慢效率低，所以我们一般都是用热部署：

* 首先添加 spring-boot-devtools 依赖

```xml
<!--
    添加一个 spring-boot-devtools 依赖，不用指定版本号，因为上面 spring-boot-starter-parent 项目里已经帮我们锁定好了
    这个库里已经帮我们添加了热部署功能，debug 模式下，它会监控 classpath 里字节码的变化（不是 target 里的），完成热部署
    也就是说，开发过程中，我们修改了代码，只需要重新 build 构建下项目，classpath 里字节码就会发生变化（不是 target 里的，所以只能用 IDEA 自带的 build，不能用 maven 的），就能完成热部署了，不用重新运行项目
-->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-devtools</artifactId>
</dependency>
```

* 然后热部署 = 修改代码 + [fn cmd f9] 构建项目 + 查看效果

#### 3、开发结束后把项目打包成 runnable jar

之前我们是把项目打包成普通 jar 或 war。现在因为 SpringBoot 内置了 Tomcat（默认的端口是 8080，默认的 ApplicationContextPath 是 /），并且我们通过代码提供了 SpringBoot 项目的入口类 Application 和入口方法 main，所以可以把项目打包成 runnable jar：

* 首先添加 spring-boot-maven-plugin 插件

```xml
<!-- 插件 -->
<plugins>
    <plugin>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-maven-plugin</artifactId>
    </plugin>
</plugins>
```

* 然后执行 mvn package 命令或者直接在 IDEA 菜单栏里双击 Maven - ${项目名} - Lifecycle - package，即可打包，产物在 target 里

* 接下来就可以通过 java -jar ${runnable jar} 来运行这个项目了



